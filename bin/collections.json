{
  "targets": [
    {
      "name": "chrome",
      "title": "The Chromium web browser"
    },
    {
      "name": "all",
      "title": "All build targets"
    },
    {
      "name": "blink_tests",
      "title": "Top target for all Blink tests"
    }
  ],
  "executables": [
    {
      "name": "devchrome",
      "title": "Chromium with user-data-dir",
      "targets": ["chrome"],
      "commands": [
        {
          "name": "normal",
          "command": [
            "${out_dir}/${Build_type}/chrome",
            "--user-data-dir=${HOME}/.chrome_dev"
          ]
        },
        {
          "name": "asan",
          "command": [
            "${out_dir}/${Build_type}/chrome",
            "--allow-file-access-from-files",
            "--disable-click-to-play",
            "--disable-gpu",
            "--disable-hang-monitor",
            "--disable-metrics",
            "--disable-popup-blocking",
            "--disable-prompt-on-repost",
            "--enable-experimental-extension-apis",
            "--enable-extension-apps",
            "--enable-extension-timeline-api",
            "--enable-nacl",
            "--enable-search-provider-api-v2",
            "--enable-video-track",
            "--js-flags=\"--expose_gc\"",
            "--new-window",
            "--no-default-browser-check",
            "--no-first-run",
            "--no-process-singleton-dialog",
            "--no-sandbox",
            "--use-fake-device-for-media-stream",
            "--use-fake-ui-for-media-stream",
            "--use-gl=osmesa",
            "--user-data-dir=${HOME}/.chrome_asan"
          ]
        },
        {
          "name": "debug",
          "command": [
            "cgdb",
            "--args",
            "${out_dir}/${Build_type}/chrome",
            "--no-sandbox",
            "--disable-hang-monitor",
            "--single-process",
            "--user-data-dir=${HOME}/.chrome_dev"
          ]
        }
      ]
    },
    {
      "name": "content_shell",
      "title": "The Chromium Content Shell (test app)",
      "targets": ["content_shell"],
      "commands": [
        {
          "name": "normal",
          "command": [
            "${out_dir}/${Build_type}/content_shell",
            "--crash-dumps-dir=${out_dir}/${Build_type}/content_shell_crashes",
            "--data-path=${HOME}/.content_shell_dev"
          ]
        },
        {
          "name": "debug",
          "command": [
            "cgdb",
            "--args",
            "${out_dir}/${Build_type}/content_shell",
            "--no-sandbox",
            "--disable-hang-monitor",
            "--data-path=${HOME}/.content_shell_dev"
          ]
        }
      ]
    },
    {
      "name": "smoothness",
      "title": "Smoothness test app",
      "targets": ["chrome"],
      "command": [
        "python",
        "tools/perf/run_measurement",
        "--browser=${build_type}",
        "smoothness"
      ]
    },
    {
      "name": "indexeddb_perf",
      "title": "IndexedDB Telemetry based performance tests",
      "targets": ["chrome"],
      "command": [
        "python",
        "tools/perf/run_measurement",
        "--browser=${build_type}",
        "indexeddb_perf"
      ]
    },
    {
      "name": "content_browsertests_apk",
      "targets": ["content_browsertests_apk", "forwarder2"],
      "commands": [
        {
          "name": "normal",
          "command": [
            "python",
            "build/android/test_runner.py",
            "gtest",
            "-s",
            "content_browsertests",
            "--verbose",
            "--${build_type}",
            "--num_retries=1"
          ]
        }
      ]
    },
    {
      "name": "content_shell_apk",
      "targets": ["content_shell_apk", "forwarder2"],
      "commands": [
        {
          "name": "normal",
          "command": [
            "python",
            "build/android/adb_install_apk.py",
            "--apk",
            "ContentShell.apk",
            "--${build_type}"
          ]
        }
      ]
    },
    {
      "name": "chrome_shell_apk",
      "targets": ["chrome_shell_apk", "forwarder2"],
      "commands": [
        {
          "name": "normal",
          "command": [
            "python",
            "build/android/adb_install_apk.py",
            "--apk",
            "ChromeShell.apk",
            "--${build_type}"
          ]
        }
      ]
    },
    {
      "name": "env_chromium_unittests_apk",
      "targets": ["env_chromium_unittests_apk", "forwarder2"],
      "commands": [
        {
          "name": "normal",
          "command": [
            "python",
            "build/android/test_runner.py",
            "gtest",
            "-s",
            "env_chromium_unittests",
            "--verbose",
            "--${build_type}",
            "--num_retries=1"
          ]
        }
      ]
    },
    {
      "names": ["content_browsertests", "browser_tests"],
      "type": "gtest",
      "commands": [
        {
          "name": "normal",
          "command": [
            "${xvfb}",
            "${out_dir}/${Build_type}/${executable_name}",
            "--test-launcher-jobs=${jobs}"
          ]
        },
        {
          "name": "debug",
          "command": [
            "cgdb",
            "--args",
            "${out_dir}/${Build_type}/${executable_name}"
          ]
        },
        {
          "name": "valgrind",
          "command": [
            "tools/valgrind/chrome_tests.sh",
            "--build-dir=${out_dir}/${Build_type}",
            "-t",
            "${executable_name}"
          ]
        }
      ]
    },
    {
      "names": ["base_unittests", "net_unittests", "unit_tests", "content_unittests"],
      "type": "gtest",
      "targets": ["xdisplaycheck", "${executable_name}"],
      "commands": [
        {
          "name": "normal",
          "command": [
            "${xvfb}",
            "${out_dir}/${Build_type}/${executable_name}",
            "--brave-new-test-launcher",
            "--test-launcher-jobs=${jobs}"
          ]
        },
        {
          "name": "debug",
          "command": [
            "cgdb",
            "--args",
            "${out_dir}/${Build_type}/${executable_name}",
            "--single-process-tests"
          ]
        },
        {
          "name": "valgrind",
          "command": [
            "tools/valgrind/chrome_tests.sh",
            "--build-dir=${out_dir}/${Build_type}",
            "-t",
            "${executable_name}"
          ]
        }
      ]
    },
    {
      "names": ["env_chromium_unittests", "performance_browser_tests",
              "webkit_unit_tests", "content_endurancetests"],
      "type": "gtest",
      "targets": ["xdisplaycheck", "${executable_name}"],
      "commands": [
        {
          "name": "normal",
          "command": [
            "${xvfb}",
            "${out_dir}/${Build_type}/${executable_name}",
            "--test-launcher-jobs=${jobs}"
          ]
        },
        {
          "name": "debug",
          "command": [
            "cgdb",
            "--args",
            "${out_dir}/${Build_type}/${executable_name}"
          ]
        },
        {
          "name": "valgrind",
          "command": [
            "tools/valgrind/chrome_tests.sh",
            "--build-dir=${out_dir}/${Build_type}",
            "-t",
            "${executable_name}"
          ]
        }
      ]
    },
    {
      "name": "blink-layout",
      "title": "The Blink layout tests",
      "targets": ["blink_tests"],
      "commands": [
        {
          "name": "normal",
          "command": [
            "${xvfb}",
            "third_party/WebKit/Tools/Scripts/run-webkit-tests",
            "--no-show-results",
            "--${build_type}",
            "--nocheck-sys-deps",
            "--clobber-old-results",
            "--no-retry-failures",
            "--no-new-test-results",
            "--fully-parallel"
          ]
        },
        {
          "name": "debug",
          "command": [
            "cgdb",
            "--args",
            "${out_dir}/${Build_type}/content_shell",
            "--no-timeout"
          ]
        },
        {
          "name": "valgrind",
          "command": [
            "tools/valgrind/chrome_tests.sh",
            "--build-dir=${out_dir}/${Build_type}",
            "-t",
            "webkit"
          ]
        }
      ]
    }
  ],
  "runs": [
    {
      "name": "smooth25",
      "title": "Page smoothness tests on the top 25 sites",
      "executable": "smoothness",
      "args": [
        "tools/perf/page_sets/top_25.json"
      ]
    },
    {
      "name": "clusterfuzz",
      "title": "Runs an ASAN-ified build",
      "targets": ["chrome", "ipc_fuzzer_replay"],
      "args": [
        "tools/ipc_fuzzer/play_testcase.py",
        "--build-type=${Build_type}",
        "--out-dir=${out_dir}"
      ]
    },
    {
      "name": "performance-browser-tests-idb",
      "title": "The IndexedDB tests from performance_browser_tests",
      "executable": "performance_browser_tests",
      "args": [
        "--gtest_filter='IndexedDBTest.Perf'"
      ]
    },
    {
      "name": "env_chromium_unittests",
      "title": "ChromiumEnv unit tests"
    },
    {
      "name": "idb_webkit_unit_tests",
      "title": "The IndexedDB tests from webkit_unit_tests",
      "executable": "webkit_unit_tests",
      "args": [
        "--gtest_filter=':*IDB*:'"
      ]
    },
    {
      "name": "idb_content_unittests",
      "title": "The IndexedDB tests from content_unittests",
      "executable": "content_unittests",
      "args": [
        "--gtest_filter=':*IndexedDB*:*LevelDB*:*IDB*:'"
      ]
    },
    {
      "name": "idb_unit_tests",
      "title": "The IndexedDB tests from unit_tests",
      "executable": "unit_tests",
      "args": [
        "--gtest_filter=':*IndexedDB*:ExtensionServiceTest.Clear*Data:'"
      ]
    },
    {
      "name": "content-browsertests-idb",
      "title": "The IndexedDB tests from content_browsertests",
      "executable": "content_browsertests",
      "args": [
        "--gtest_filter=':*IndexedDB*:'"
      ]
    },
    {
      "name": "idb-content-browsertests-android",
      "title": "The IndexedDB tests from content_browsertests on Android",
      "executable": "content_browsertests_apk",
      "args": [
        "--gtest_filter=':*IndexedDB*:'"
      ]
    },
    {
      "name": "idb_browser_tests",
      "title": "The IndexedDB tests from browser_tests",
      "executable": "browser_tests",
      "args": [
        "--gtest_filter=':*IndexedDB*:BrowserActionApiTest.IncognitoBasic:BrowsingDataIndexedDBHelperTest:'"
      ]
    },
    {
      "name": "blink-layout-idb",
      "title": "The IndexedDB subset of the Blink layout tests",
      "executable": "blink-layout",
      "args": [
        "storage/indexeddb"
      ]
    },
    {
      "name": "blink-layout-idb-single",
      "title": "The IndexedDB subset of the Blink layout tests",
      "executable": "blink-layout",
      "args": [
        "${layout_dir}/storage/indexeddb/event-init.html"
      ],
      "-commands": [
        "--fully-parallel"
      ]
    }
  ],
  "collections": [
    {
      "name": "unit-idb",
      "title": "Run all IndexedDB unit tests",
      "runs": ["env_chromium_unittests", "idb_webkit_unit_tests",
               "idb_content_unittests", "idb_unit_tests",
               "content-browsertests-idb", "idb_browser_tests"]
    },
    {
      "name": "unit-all",
      "title": "Run *all* unit tests",
      "executables": ["env_chromium_unittests", "webkit_unit_tests",
               "content_unittests", "unit_tests",
               "content_browsertests", "browser_tests"]
    },
    {
      "name": "perf-idb",
      "title": "Run all IdexedDB performance tests",
      "executables": ["performance_browser_tests"]
    }
  ],
  "default": "chrome"
}
