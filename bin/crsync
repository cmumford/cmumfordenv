#!/bin/bash -e

top_dir=`pwd`

# Update depot tools
gclient --version
gclient --version

echo ""
echo "Updating/rebasing Blink..."
cd ${top_dir}/third_party/WebKit
git fetch origin
git rebaseall
git checkout master

echo ""
echo "Updating/rebasing Chromium..."
cd ${top_dir}
git fetch origin
git rebaseall
git checkout master

echo ""
echo "Updating/rebasing Leveldb"
cd ${top_dir}/third_party/leveldatabase/src
git fetch origin
git rebaseall
git checkout master

echo ""
echo "Syncing all projects..."
cd ${top_dir}
gclient sync

# Now delete my gyp state file to force crbuild to regyp
rm -f .GYP_STATE
